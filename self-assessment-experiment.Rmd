---
title: "Reproducibility of GIScience MSc Theses - Self-assessment experiment"
author:
  - name: Carlos Granell
    affiliation: Universitat Jaume I of Castellón, Spain
date: "15/04/2020 (updated `r format(Sys.time(), '%d %B, %Y')`)"
output:
  html_document: 
    df_print: paged
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 4
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '4'
  word_document:
    toc: yes
abstract: |
  This document analyses the responses to a pre-test questionnaire and post-test questionnaire in the framework of an initiative on the [self-assesment of reproducibility level of master's thesis in GIScience](https://osf.io/j97zp/) carried out during the academic year 2019/20 with master's students enrolled in two GIS-related master's programmes: [Erasmus Mundus MSc in Geospatial Technologies](https://mastergeotech.info/) and [MSc Geomatics](https://www.tudelft.nl/en/education/programmes/masters/geomatics/msc-geomatics/). The overarching goal of the iniciative is to explore teaching strategies to increase the exposure to and understanding of Reproducible Research by master-level students in the area of GIScience. 
urlcolor: blue
bibliography: references.bib
---

```{r setup, include=FALSE, eval=TRUE}
knitr::opts_chunk$set(echo=FALSE)
```

# Preliminaries 

## Software dependencies

This document does not install the required R packages by default. You can run the script `install.R` to install all required dependencies on a new R installation, or use `install.packages(..)` to install missing R packages.

```{r install_r, eval=FALSE}
source("install.R")
```


## Required libraries

```{r load_libraries, echo=TRUE, message=FALSE, warning=FALSE}
library("tidyverse")
library("forcats")
library("kableExtra")
library("here")
library("stringr")
library("googlesheets4")
library("likert")
library("magick")
library("patchwork")
library("ggthemes")
```

```{r load_functions, echo=TRUE, message=FALSE, warning=FALSE}
source("functions.R")

```


```{r set_seed}
# just in case
set.seed(nchar("Self-assessment experiment"))
```

## Reproduce paper

To create the PDF of the computational notebook you can run the following commands in a new R session.
If you have problems rendering the PDF you can execute each chunk independently in [RStudio](https://rstudio.com/products/rstudio/).

```{r render_with_rmarkdown, eval=FALSE, echo=TRUE}
require("knitr")
require("rmarkdown")
rmarkdown::render("self-assessment-experiment.Rmd", output_format = "pdf_document")
```

# Data & methods


## Participants

Eligible participants were initially all students enrolled in the Master Thesis Project in the academic year 2019/2020 from two GIS-related master programmes:[Erasmus Mundus MSc in Geospatial Technologies](https://mastergeotech.info/) and [MSc Geomatics](https://www.tudelft.nl/en/education/programmes/masters/geomatics/msc-geomatics/). The former is offered by three universities (UJI, NOVA IMS Lisboa and Münster), the latter by TU Delft. As participation was voluntary, the experiment was not counted towards the final grade of the master's thesis.

Students who also answered the questionnaires but were not enrolled in the master programmes above (e.g., PhD students who participated in a doctoral course at UJI) were removed from the analysis. Fields that refer to personal information (email, thesis handlers, url to pdf files) were also removed and therefore not used in the analysis.


```{r data_files}

pretest_filtered_filename <- "pretest_filtered.csv"
pretest_filtered_file <- here::here("data", pretest_filtered_filename)

postest_filtered_filename <- "postest_filtered.csv"
postest_filtered_file <- here::here("data", postest_filtered_filename)

selfassessment_filtered_file <- here::here("data", "selfassessment_filtered.csv")

```

```{r data_download, eval=FALSE}
# Link to pre-questionnaire data (responses) 
pretest_sheet <- googlesheets4::read_sheet("https://drive.google.com/open?id=1YhcOeTg04AXh7mbDzjqefuuHUG91sr98e15rl92M2Zk")

# Link to post-questionnaire data (responses) 
postest_sheet <- googlesheets4::read_sheet("https://drive.google.com/open?id=1gsf9I_H34ymYvZGGYhzGNk7NoeneJoJl0bAP8NjNRAI")

# Link to the self-assessment done by students from the Erasmus Master MSc in Geospatial Technologies 
selfassessment_sheet <- googlesheets4::read_sheet("https://drive.google.com/open?id=1a51epnQviXJhLLuKu5Gn6m_hqv4NnMzNLNlt_gQcqCE")
```


```{r pretestdata_filtered, eval=FALSE}
pretest_sheet_filtered <- 
  pretest_sheet %>%
  filter(`Please choose your MASTER programme` %in% c("MSc in Geospatial Technologies (UJI, NOVA IMS, IFGI-WWU)", 
                                                      "MSc Geomatics Master (TU Delft)")) %>%
  mutate(id = row_number()) %>%
  rename(email = `Please introduce your university E-MAIL address`) %>%
  left_join(selfassessment_sheet, by="email") %>%
  # Through manual inspection, I noticed one student answered twice the pre-test with different emails. Removed one entry
  filter(email != "cjavierdelgadog@gmail.com") %>% 
  select(-email, -handle, -url_pdf) 

```

```{r postetsdata_filtered, eval=FALSE}

postest_sheet_filtered <- 
  postest_sheet %>%
  filter(`Please choose your MASTER programme` %in% c("MSc in Geospatial Technologies (UJI, NOVA IMS, IFGI-WWU)", 
                                                      "MSc Geomatics Master (TU Delft)")) %>%
  mutate(id = row_number()) %>%
  rename(email = `Please introduce your university E-MAIL address`) %>%
  drop_na(email) %>% 
  left_join(selfassessment_sheet, by="email") %>%
  select(-email, -handle, -url_pdf)
```


```{r seflassessment_filtered, eval=FALSE}

selfassessment_sheet_filtered <- 
  selfassessment_sheet %>%
  select(-email, -handle, -url_pdf)
```



```{r data_save, eval=FALSE}

write.csv(pretest_sheet_filtered, file = pretest_filtered_file)

write.csv(postest_sheet_filtered, file = postest_filtered_file)

write.csv(selfassessment_sheet_filtered, file = selfassessment_filtered_file)

```


## Methodological steps

A brief summary of the steps followed are described below. Additional notes are also [available](https://docs.google.com/document/d/1Ev5Q2fbzrv8PQxMC9nDBUYy73AqrvZOaT3uRjAkvWIU/edit?usp=sharing).

- Step 1. Participants answered the [first questionnaire](https://forms.gle/BTmPc5ExhEJNkUtFA) (pre-test assessment) at the start of the semester (or master thesis project/course).

- Step 2. In the [OSF web site](https://osf.io/j97zp/), participants were provided with an [introductory 5-minute video lecture](https://osf.io/pnw2q/) to the initiative and [20-minute video lecture to the topic of reproducibility](https://osf.io/f756x/). 

- Step 3. In the same [web site](https://osf.io/j97zp/), participants were also given 3 self-study, self-paced assignments (in PDF format) to introduce them to the methods and tools for reproducibility research. To support them, we also set up a GitHub repo as a [discussion service](https://github.com/erasmus-mundus-geotech-master/reproducibility-self-assessment) to allow all students to discuss questions with regard to the assignments and the reproducibility self-assessment of their theses.

- Step 4. Participants were asked to self-assess the level of reproducibility of their master theses, as explained in the first video lecture. In practice, it meant to add a simple statement (last line) to the abstract indicating the level (score) of each of the five criteria [@nust2018].

- Step 5. At the end of the semester (or master thesis project/course), participants answered a [second questionnaire](https://forms.gle/KCD5Ym4VJRmZzZqNA) (post-test assessment).

## Questionnaires

The list of questions of each questionnaire were discussed and agreed in a [shared document](https://docs.google.com/document/d/1n9MJVsP6xZ61UW7vlXwttzZeFbgSchBOpMDgYlIiQis/edit).
 
[Questionnaire #1 (pre-test)](https://forms.gle/BTmPc5ExhEJNkUtFA) is divided in three sections: 

1. Previous knowledge/experience on reproducible research, 
2. Current working practices, and 
3. Previous education background/work experience/etc. 

[Questionnaire #2 (post-test)](https://forms.gle/KCD5Ym4VJRmZzZqNA) is divided in two sections: 

1. Knowledge/experience acquired on reproducible research compared to what was stated in questionnaire #1, and
2. Perceived importance of reproducibility in their future careers.

Section 1 in both questionnaires is pretty much the same, as the list of 15 terms are asked at the start and end of the semester.

## Training materials 

Training materials developed for the experiment are publicly available in the OSF project ["Reproducibility of GIScience MSc Theses - Self-assessment experiment" on the Open Science Framework](https://osf.io/j97zp/).

- [Introduction lecture to self-assessment reproducibility experiment](https://osf.io/pnw2q/)
- [Introduction lecture to reproducibility](https://osf.io/f756x/)
- [First self-study assignment](https://osf.io/b3myq/)
- [Second self-study assignment](https://osf.io/8p7sd/)
- [Third self-study assignment](https://osf.io/6f5pm/)

## Reproducibility self-assessment data

The master's theses of the students of the _Erasmus Mundus MSc in Geospatial Technologies_ are openly available in an [institutional repository](https://run.unl.pt/handle/10362/2259/browse?type=dateissued&sort_by=3&order=ASC&rpp=30&etal=-1&year=2020&month=-1&starts_with=). Most of the participating students added the self-assessment sentence in the specified format.

The master's theses of the students of the TU Delft's _MSc Geomatics_ are openly available in an [instituational repository](https://3d.bk.tudelft.nl/education/#theses). Here, none of the students added the self-assessment sentence as requested. However, some of them added an appendix to their theses to reflect on the reproducibility of the thesis in a narrative way.

# Results

The following plots and tables are based on the files `r pretest_filtered_filename` and `r postest_filtered_filename` in the folder `data`. Only students from _MSc in Geospatial Technologies (UJI, NOVA IMS, IFGI-WWU)_ and _MSc Geomatics (TU Delft)_ are analysed.

```{r evaldata_load, warning=FALSE}

category_levels <- c("0", "1", "2", "3")

cols(
   .default = col_character(),
   input_data = col_factor(levels = category_levels),
   preprocessing = col_factor(levels = category_levels),
   methods = col_factor(levels = category_levels),
   computational_environment = col_factor(levels = category_levels),
   results = col_factor(levels = category_levels),
   self_assessment = col_logical()
) -> export_cols

pretest_data <- read_csv(
  file = pretest_filtered_file, 
  col_names = TRUE, 
  trim_ws=TRUE,
  col_types = export_cols,
  na = "NA")

names(pretest_data) <- names(pretest_data) %>% 
  sub(pattern = "Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them\\? \\[*", 
      replacement = "") %>% 
  sub(pattern = "\\]", replacement = "")


postest_data <- read_csv(
  file = postest_filtered_file, 
  col_names = TRUE, 
  trim_ws=TRUE,
  col_types = export_cols,
  na = "NA")

names(postest_data) <- names(postest_data) %>% 
  sub(pattern = "Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them\\? \\[*", 
      replacement = "") %>% 
  sub(pattern = "\\]", replacement = "")


cols(
   input_data = col_factor(levels = category_levels),
   preprocessing = col_factor(levels = category_levels),
   methods = col_factor(levels = category_levels),
   computational_environment = col_factor(levels = category_levels),
   results = col_factor(levels = category_levels),
   self_assessment = col_logical()
) -> export_cols


selfassessment_data <- read_csv(
  file = selfassessment_filtered_file,
  col_names = TRUE,
  trim_ws = TRUE,
  col_types = export_cols,
  na = "NA")

# Terms organised according to the five "schools of thoughts"
# cher & Friesike (2014). Open Science: One Term, Five Schools of Thought. https://doi.org/10.1007/978-3-319-00026-8_2
terms <- tibble(
  school = c(rep("democratic", 6), rep("pragmatic", 5), rep("infrastructure", 4), rep("public", 3)),
  column = names(pretest_data)[7:24]
)

```

```{r likert_levels}
likert_levels <- c("I have never heard of this term",
                   "I have heard this term before, but I have a vague idea of what it is",
                   "I am familiar with the term but it would be difficult to explain it",
                   "I can explain this term in my own words but I do not use it myself",
                   "I can easily define what exactly this term means and I use it myself")

likert_factor <- function(x) {factor(x, levels = likert_levels)}

```

```{r pretestdata_to_likert}
pretest_data <- 
  pretest_data %>%
  mutate_at(pull(terms, column), likert_factor) %>%
  select(-X1)

```


```{r postestdata_to_likert}
postest_data <- 
  postest_data %>%
  mutate_at(pull(terms, column), likert_factor) %>%
  select(-X1)

```


## MSc in Geospatial Technologies  (UJI, NOVA IMS, IFGI-WWU)

```{r master_title}
master_programme <- "MSc in Geospatial Technologies"
```


### Questionnaire #1 (pre-test) 

```{r pretest_geotec_stats}

geotech_pretest <- 
  pretest_data %>%
  filter(`Please choose your MASTER programme` == c("MSc in Geospatial Technologies (UJI, NOVA IMS, IFGI-WWU)"))

# total number of students enrolled in master thesis subject in the MSc in Geospatial Technologies (2019/20) 
geotech_total_students <- 25
geotech_n_participants <- nrow(geotech_pretest)
geotech_n_trained <- nrow(geotech_pretest %>% filter(`Have you ever been TRAINED on reproducible research practices?` == "YES"))

geotech_n_did_selfassessment <- nrow(selfassessment_data)

```

- `r geotech_total_students` students of the EM MSc in Geospatial Technologies _did_ eventually deliver the master thesis project.

- `r round((geotech_n_participants / geotech_total_students)*100, 0)`% (`r geotech_n_participants `/`r geotech_total_students`) of students answered the first questionnaire. All but one added the self-assessment statement to the thesis manuscript.

- `r round((geotech_n_did_selfassessment / geotech_total_students)*100, 0)`% (`r geotech_n_did_selfassessment `/`r geotech_total_students`) of students added a self-assessment statement to the master thesis. Two of them _did not_ answered the questionnaire #1, so they are not included in the analysis.

#### Section 1: Previous knowledge/experience on reproducible research

`r geotech_n_trained` (out of `r geotech_n_participants`) students answered that they have been previously trained on reproducible research practices. 


```{r pretest_geotech_terms, warning=FALSE}
results <- 
  geotech_pretest %>%
  select(pull(terms, column)) %>%
  as.data.frame() %>%
  likert()

summaries <- 
  summary(results) %>%
  inner_join(terms, by=c("Item" ="column")) %>%
  select(school, Item, low, neutral, high, mean, sd)
```

__Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them?__

```{r pretest_geotech_terms_table}
kable(summaries,
      digits = 2,
      row.names = FALSE,
      col.names = c("School of thought", "Term", "low (%)", "neutral (%)", "high (%)", "mean", "sd"),
      format = "html",
      booktabs = TRUE,
      caption = paste0("Percentage of answers in the disagree (low), agree (high) or neutral categories.\n",
                       "Mean response with standard deviation using numeric values 1 to 5 for 'Strongly disagree' to 'Strongly agree'.\n",
                       "Terms are ordered by 'high' category.")) %>%
      kableExtra::kable_styling(full_width = TRUE) %>%
      kableExtra::scroll_box(height = "300px")
```

Table above is the raw data to create the likert-scale plot in next Figure. Students had previous knowledge (reddish answers >= 50%) for the 9 top terms, which are `r summaries$Item[1:9]`. The next term, `r summaries$Item[10]`, is to some extent knowledgeable, as 1/3 opted for the neutral response The rest of terms, `r summaries$Item[11: length(summaries$Item)]`, are in general poorly known and/or understood. This suggests that terms closely connected to reproducibility (mostly from the _pragmatic_ School of Thought, see [@fecher2014open]) were in general unknowledgeable (yellowish answers predominate). 



```{r pretest_geotech_terms_fig, fig.width=14, fig.height=10, dpi=300}
plot(results, type="bar", legend = "", legend.position="bottom",
     centered=TRUE, text.size=4,
     low.color = "indianred4", high.color="goldenrod2") +
  labs(title = "How well do you KNOW these terms?",
       subtitle = paste0(master_programme, " (N=", geotech_n_participants, ")"),
       caption = "Data: Questionnaire #1 (pre-test)") +
  guides(fill=guide_legend(nrow=3, byrow=TRUE)) +
  # theme_bw()
  theme_wsj(base_size = 12) + 
  theme(plot.title = element_text(size=20), 
        plot.subtitle = element_text(size=16), 
        plot.caption = element_text(size=10))


ggsave(here::here("figs", "fig01_geotech_pretest.png"), width = 14, height = 10, dpi = 300)


```

_Questions related to previous experience in reproducibility, main difficulties and perceived importance_

```{r pretest_geotech_perception}
yesno_levels <- c("YES", "NO")
percepcion_levels <- c("1", "2", "3", "4", "5")

geotech_pretest <- 
  geotech_pretest %>%
  mutate(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?` = factor(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`, levels = yesno_levels),
         `Have you ever had to REUSE YOUR OWN past code/data?` = factor(`Have you ever had to REUSE YOUR OWN past code/data?`, levels = yesno_levels),
         `Please rate the perceived IMPORTANCE of doing your research in a reproducible way` = factor(`Please rate the perceived IMPORTANCE of doing your research in a reproducible way`, levels = percepcion_levels))
```


```{r pretest_geotech_perception_table}
options(knitr.kable.NA = '-')
kable(geotech_pretest %>% 
      select(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`,
             `Have you ever had to REUSE YOUR OWN past code/data?`,
             `If you answered YES in either of the last two questions, please explain which were the MAIN DIFFICULTIES you experienced. If NO, skip question`,
             `Do you know where to look for HELP and extra information to make your research reproducible?`,
             `Please rate the perceived IMPORTANCE of doing your research in a reproducible way`,
             `According to you, why is it IMPORTANT (or not) to do your research in a reproducible way?`),
      booktabs = TRUE,
      caption = paste0("Previous experience in reproducibility, main difficulties and perceived importance, \n",
                        "using numeric values 1 to 5 for 'No important at all' to 'Really important'.")) %>% 
  kableExtra::kable_styling(full_width = TRUE) %>%
  kableExtra::scroll_box(height = "600px")
  
```

The plots below refer to the questions above with numeric/logical answers.

```{r pretest_geotech_perception_fig, fig.width=10}
categoryColumns <- c("Have you ever experienced \nDIFFICULTIES IN REUSING \nsomebody else’s code / data?",
                     "Have you ever had to \nREUSE YOUR OWN \npast code/data?",
                     "Please rate the perceived \nIMPORTANCE of doing your \nresearch in a reproducible way")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")

fig_barplot <- patchwork::wrap_plots(
  ncol = length(categoryColumns),
  questions_barplot(geotech_pretest, 
                    `Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`, 
                    main = paste("A:", categoryColumns[1]), 
                    colour = 1, 
                    yesno_levels),
  questions_barplot(geotech_pretest, 
                    `Have you ever had to REUSE YOUR OWN past code/data?`, 
                    main = paste("B:", categoryColumns[2]), 
                    colour = 2, 
                    yesno_levels),
  questions_barplot(geotech_pretest, 
                    `Please rate the perceived IMPORTANCE of doing your research in a reproducible way`, 
                    main = paste("C:", categoryColumns[3]), 
                    colour = 3, 
                    percepcion_levels)
  )

fig_barplot

ggsave(fig_barplot, file = here::here("figs", "fig02_geotech_pretest.png"), 
       width = 10, height = 5, dpi = 300)
```


A large majority of students encountered difficulties trying to reproduce their own code or someone else's code (A and B). The third column in the table above shows the problems the students faced. In general students gave importance to reproducibility research practices (C). As students had the chance to reproduce others' works, reproducibility practices seem to be key for them; however, they find barriers to put these practices into practice.


#### Section 2: Current working practices

```{r pretest_geotech_working_practices}
questions_practices <- tibble(
  analysis = c("What tools do you plan to use to ANALYSE data?"),
  visualisation =c("What tools do you plan to use to VISUALISE/PLOT data?"),
  writing = c("What tools do you plan to WRITE UP your master thesis or conference/journal article?"),
  workflow = c("What is your (expected) process of GETTING the summary data, statistical results, figures, maps and tables IN your master thesis document (or conference/journal article)?"))


practices <- function(data, group) {
  data %>%
    separate_rows(practice, sep = "\\),") %>%   # But ")" is also gone..
    mutate(practice = stringr::str_trim(practice),
           practice = if_else(str_sub(practice, -1) == ")", practice, paste0(practice, ")"))) %>%
    add_column(practice_group=group)
}


working_practices <- data.frame()
for (q in 1:length(questions_practices)) {
  res <- practices(select(geotech_pretest, practice = questions_practices[[q]]), names(questions_practices)[q])
  working_practices <- bind_rows(working_practices, res)
}



kable(t(questions_practices),
      col.names = c("Practice group - Survey question"), 
      format = "html",
      booktabs = TRUE,
      caption = paste0("Note that responses to 'working practices' were multi-choice (N=", geotech_n_participants, ").")) %>%
  kable_styling(full_width = TRUE)
```

```{r pretest_geotech_practices_fig, fig.width=15, fig.height=10, dpi=300}

max_bar <- 12
ggplot(working_practices, aes(x=forcats::fct_infreq(practice))) +
    geom_bar(aes(fill=factor(practice_group))) +
    coord_flip() +
    labs(title = "What tools do you plan to use to...?",
         x = "Number of responses",
         y = "Working practices") +
    facet_grid(rows = vars(practice_group), scales = "free_y") +
    guides(fill= FALSE) +
    scale_fill_brewer(palette="Set1") +
    scale_y_continuous(breaks = seq(0, max_bar, by=2)) +
    # theme_bw()
    theme_wsj(base_size = 12) + theme(plot.title = element_text(size=16))

ggsave(here::here("figs", "fig03_geotech_pretest.png"), width = 15, height = 10, dpi = 300)
```



#### Section 3: Previous education background / work experience /...


```{r pretest_geotech_background_table}
# options(knitr.kable.NA = '-')
kable(geotech_pretest %>% 
      select(`What BACHELOR DEGREE (or equivalent) did you have when applying for the master programme?`,
             `How many years of PROFESSIONAL EXPERIENCE did you have when applying for the master programme?`,
             `How many years of PROFESSIONAL EXPERIENCE did you have when applying for the master programme?`,
             `In which context are you DEVELOPING your master thesis?`,
             `Please select which sentence better describes the PLAN you have after the completion of your Master thesis`),
      booktabs = TRUE,
      caption = "Previous education background and work experience, and prospects for future.") %>%
  kable_styling(full_width = TRUE)
  
```


### Questionnaire #2 (post-test)


```{r postest_geotec_stats}

geotech_postest <- 
  postest_data %>%
  filter(`Please choose your MASTER programme` == c("MSc in Geospatial Technologies (UJI, NOVA IMS, IFGI-WWU)"))

geotech_n_participants_post <- nrow(geotech_postest)

```

- `r round((geotech_n_participants_post / geotech_total_students)*100, 0)`% (`r geotech_n_participants_post `/`r geotech_total_students`) of students answered the second questionnaire. All added the self-assessment statement to the thesis manuscript.


#### Section 1: Previous knowledge/experience on reproducible research


```{r postest_geotech_terms, warning=FALSE}
results <- 
  geotech_postest %>%
  select(pull(terms, column)) %>%
  as.data.frame() %>%
  likert()

summaries <- 
  summary(results) %>%
  inner_join(terms, by=c("Item" ="column")) %>%
  select(school, Item, low, neutral, high, mean, sd)
```

__Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them?__

```{r postest_geotech_terms_table}
kable(summaries,
      digits = 2,
      row.names = FALSE,
      col.names = c("School of thought", "Term", "low (%)", "neutral (%)", "high (%)", "mean", "sd"),
      format = "html",
      booktabs = TRUE,
      caption = paste0("Percentage of answers in the disagree (low), agree (high) or neutral categories.\n",
                       "Mean response with standard deviation using numeric values 1 to 5 for 'Strongly disagree' to 'Strongly agree'.\n",
                       "Terms are ordered by 'high' category.")) %>%
      kableExtra::kable_styling(full_width = TRUE) %>%
      kableExtra::scroll_box(height = "300px")
```

Table above is the raw data to create the likert-scale plot in next Figure. 


```{r postest_geotech_terms_fig, fig.width=14, fig.height=14, dpi=300}
plot(results, type="bar", legend = "", legend.position = "bottom",
     centered=TRUE, text.size=4, 
     low.color = "indianred4", high.color="goldenrod2") +
  labs(title = "How well do you KNOW these terms?",
       subtitle = paste0(master_programme, " (N=", geotech_n_participants_post, ")"),
       caption = "Data: Questionnaire #2 (post-test)") +
  guides(fill=guide_legend(nrow=3, byrow=TRUE)) +
  # theme_bw()
  theme_wsj(base_size = 12) + 
  theme(plot.title = element_text(size=20), 
        plot.subtitle = element_text(size=16), 
        plot.caption = element_text(size=10))

ggsave(here::here("figs", "fig04_geotech_postest.png"), width = 14, height = 10, dpi = 300)


  
```

__Have you read/watched the available materials (slides, videos, additional papers,etc)?__


```{r postest_geotech_materials}

material_levels <- unique(geotech_postest$`Have you read/watched the available materials (slides, videos, additional papers,etc)?`)
geotech_postest <- 
  geotech_postest %>%
  mutate(`Have you read/watched the available materials (slides, videos, additional papers,etc)?` = factor(`Have you read/watched the available materials (slides, videos, additional papers,etc)?`, levels = material_levels))

```


```{r postest_geotech_materials_fig, fig.width=5, fig.height=4}
categoryColumns <- c("Have you read/watched the available materials \n(slides, videos, additional papers,etc)?")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")

fig_barplot <- questions_barplot(geotech_postest, 
                    `Have you read/watched the available materials (slides, videos, additional papers,etc)?`, 
                    main = paste("A:", categoryColumns[1]), 
                    colour = 1, 
                    material_levels)

fig_barplot

ggsave(fig_barplot, file = here::here("figs", "fig05_geotech_postest.png"), 
       width = 5, height = 4, dpi = 300)


```

#### Section 2: Perceived importance of reproducibility in their future careers


```{r postest_geotech_perception}
# yesno_levels <- c("YES", "NO")
# percepcion_levels <- c("1", "2", "3", "4", "5")
adapt_levels <- unique(geotech_postest$`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`)

geotech_postest <- 
  geotech_postest %>%
  mutate(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?` = factor(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`, levels = adapt_levels),
         `Are you planning to learn more about reproducible research on your own?` = factor(`Are you planning to learn more about reproducible research on your own?`, levels = percepcion_levels),
         `How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?` = factor(`How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`, levels = percepcion_levels))
```


```{r postest_geotech_perception_table}
options(knitr.kable.NA = '-')
kable(geotech_postest %>% 
      select(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`,
             `Are you planning to learn more about reproducible research on your own?`,
             `How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`),
      booktabs = TRUE,
      caption = paste0("Perceived importance of reproducibility in the future, \n",
                        "using numeric values 1 to 5 for 'No important at all' to 'Really important'.")) %>% 
  kableExtra::kable_styling(full_width = TRUE) %>%
  kableExtra::scroll_box(height = "600px")
  
```

The plots below refer to the questions above.

```{r postest_geotech_perception_fig, fig.width=12, fig.height=6}
categoryColumns <- c("Are you going to use/adapt \nreproducible research practice(s) \nin your current and/or future \nresearch project?",
                     "Are you planning to learn more \nabout reproducible research on your own?",
                     "How important are \nreproducibility practices for \nyour future professional career?")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")

p1 <- questions_barplot(
  geotech_postest, 
  `Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`, 
  main = paste("A:", categoryColumns[1]), 
  colour = 1, 
  adapt_levels)

p2 <- questions_barplot(
  geotech_postest, 
  `Are you planning to learn more about reproducible research on your own?`, 
  main = paste("B:", categoryColumns[2]), 
  colour = 2, 
  percepcion_levels)

p3 <- questions_barplot(
  geotech_postest, 
  `How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`, 
  main = paste("C:", categoryColumns[3]), 
  colour = 3, 
  percepcion_levels)
  
p1 + p2 + p3 

ggsave(file = here::here("figs", "fig06_geotech_postest.png"),
       width = 12, height = 6, dpi = 300)


```

### Side-by-side comparison


```{r both_geotec_stats}

geotech_pretest %>%
  select(pull(terms, column)) %>%
  add_column(survey_id = "pretest") -> geotech_1

geotech_postest %>%
  select(pull(terms, column)) %>%
  add_column(survey_id = "postest") -> geotech_2


geotech_all <- bind_rows(geotech_1, geotech_2)

```



```{r both_geotech_terms, warning=FALSE}
geotech_all %>%
  select(-survey_id) %>%
  as.data.frame() %>%
  likert(grouping = geotech_all$survey_id) -> results_survey

```

__Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them?__

```{r both_geotech_terms_fig, fig.width=14, fig.height=18, dpi=300}
plot(results_survey, type="bar", legend = "", legend.position = "bottom",
     centered=TRUE, text.size=4, 
     low.color = "indianred4", high.color="goldenrod2",
     group.order = c("pretest", "postest")) +
  labs(title = "How well do you KNOW these terms (before vs after)?",
       subtitle = paste0(master_programme, " (N=", nrow(geotech_all), ")"),
       caption = "Data: Questionnaires #1 + #2 (pre-test + post-test)") +
  guides(fill=guide_legend(nrow=3, byrow=TRUE)) +
  # theme_bw()
  theme_wsj(base_size = 12) + 
  theme(plot.title = element_text(size=20), 
        plot.subtitle = element_text(size=16), 
        plot.caption = element_text(size=10))  

ggsave(here::here("figs", "fig07_geotech_both.png"), width = 14, height = 18, dpi = 300)

```


[Wilcoxon signed-rank test](https://stackoverflow.com/questions/37316209/likert-analysis-using-wilcoxon-to-determine-significance-between-pre-and-post-s)

https://rpubs.com/dgolicher/Limert_scale_analysis


### Results of self-assessment reproducibility

```{r selfassessment_fig, fig.width=10, fig.height=8}
# match the colours to time series plot below
categoryColumns <- c("input_data", 
                     "preprocessing",
                     "methods",
                     "computational_environment",
                     "results")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")
# level_names <- c("0", "1", "2", "3", NA)

p1 <- criteria_barplot(
  geotech_pretest,
  `input_data`,
  main = "A: Input data",
  colour = 1)

p2 <- criteria_barplot(
  geotech_pretest,
  `preprocessing`,
  main = "B: Preprocessing",
  colour = 2)

p3 <- criteria_barplot(
  geotech_pretest,
  `methods`,
  main = "C: Methods/Analysis/\nProcessing",
  colour = 3)

p4 <- criteria_barplot(
  geotech_pretest,
  `computational_environment`,
  main = "D: Computational\nEnvironment",
  colour = 4)

p5 <- criteria_barplot(
  geotech_pretest,
  `results`,
  main = "D: Results",
  colour = 5)


img_abstract_sentence <- magick::image_read(here::here("figs", "abstract-selfassessment-example.PNG"))

p_abstract_sentence <- magick::image_ggplot(img_abstract_sentence)


(p1 + p_abstract_sentence + p5) / (p2 + p3 + p4)

ggsave(here::here("figs", "fig08_geotech_selfassessment.png"), width = 8, height = 7, dpi = 300)

```

The distribution of the reproducibility levels by criteria contrasts notably with the results obtained for the evaluation of the AGILE/GIScience papers Surprisingly, all the criteria achieve level `3`, the highest (ideal) reproducibility level. `NA` level count (1 per criterion) corresponds to the student who answered the questionnaire but did not do the self-assessment. So, NA's are not relevant for the analysis; none of the students who _did_ the self-assessment assigned NA values to the criteria. Indeed, the lowest score for any criteria was `1` which sets the bar quite high. Without a reproducibility check by a third person, these self-assessment values seem to be quite inflated, well above the standards level we found in academic publications. This can be interpreted at least in tow ways. First, master theses were of outstanding quality with regards reproducibility (_really?_). Second, or the most credible interpretation, students did not understand well the reproducibility levels and criteria and failed to do an objective self-evaluation.



<!--
THIS IS THE ANALISIS OF THE STUDENTS IN THE MSc GEOMATICS 
-->



## MSc Geomatics (TU Delft) 

```{r}
master_programme <- "MSc Geomatics"
```

### Questionnaire #1 (pre-test) 
```{r pretest_geomatics_stats}

geomatics_pretest <- 
  pretest_data %>%
  filter(`Please choose your MASTER programme` == c("MSc Geomatics Master (TU Delft)"))

# total number of students enrolled in master thesis subject in the MSc Geomatics (2019/20) 
geomatics_total_students <- 30  #FIXME: to be confirmed
geomatics_n_participants <- nrow(geomatics_pretest)
geomatics_n_trained <- nrow(geomatics_pretest %>% filter(`Have you ever been TRAINED on reproducible research practices?` == "YES"))

```

- `r geomatics_total_students` students of the MSc Geomatics _did_ eventually deliver the master thesis project.

- `r round((geomatics_n_participants / geomatics_total_students)*100, 0)`% (`r geomatics_n_participants `/`r geomatics_total_students`) of students answered the first questionnaire.

#### Section 1: Previous knowledge/experience on reproducible research

`r geomatics_n_trained` (out of `r geomatics_n_participants`) students answered that they have been previously trained on reproducible research practices. 


```{r pretest_geomatics_terms, warning=FALSE}
results <- 
  geomatics_pretest %>%
  select(pull(terms, column)) %>%
  as.data.frame() %>%
  likert()

summaries <- 
  summary(results) %>%
  inner_join(terms, by=c("Item" ="column")) %>%
  select(school, Item, low, neutral, high, mean, sd)
```

__Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them?__

```{r pretest_geomatics_terms_table}
kable(summaries,
      digits = 2,
      row.names = FALSE,
      col.names = c("School of thought", "Term", "low (%)", "neutral (%)", "high (%)", "mean", "sd"),
      format = "html",
      booktabs = TRUE,
      caption = paste0("Percentage of answers in the disagree (low), agree (high) or neutral categories.\n",
                       "Mean response with standard deviation using numeric values 1 to 5 for 'Strongly disagree' to 'Strongly agree'.\n",
                       "Terms are ordered by 'high' category.")) %>%
      kableExtra::kable_styling(full_width = TRUE) %>%
      kableExtra::scroll_box(height = "300px")
```

Table above is the raw data to create the likert-scale plot in next Figure. 


```{r pretest_geomatics_terms_fig, fig.width=15, fig.height=14, dpi=300}
plot(results, type="bar", legend = "", legend.position = "bottom",
     low.color = "goldenrod2", high.color="indianred4") +
  ggtitle(paste0("How well do you KNOW these terms? (N=", geomatics_n_participants, ")")) + 
  theme_bw()

```


_Questions related to previous experience in reproducibility, main difficulties and perceived importance_

```{r pretest_geomatics_perception}
yesno_levels <- c("YES", "NO")
percepcion_levels <- c("1", "2", "3", "4", "5")

geomatics_pretest <- 
  geomatics_pretest %>%
  mutate(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?` = factor(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`, levels = yesno_levels),
         `Have you ever had to REUSE YOUR OWN past code/data?` = factor(`Have you ever had to REUSE YOUR OWN past code/data?`, levels = yesno_levels),
         `Please rate the perceived IMPORTANCE of doing your research in a reproducible way` = factor(`Please rate the perceived IMPORTANCE of doing your research in a reproducible way`, levels = percepcion_levels))
```


```{r pretest_geomatics_perception_table}
options(knitr.kable.NA = '-')
kable(geomatics_pretest %>% 
      select(`Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`,
             `Have you ever had to REUSE YOUR OWN past code/data?`,
             `If you answered YES in either of the last two questions, please explain which were the MAIN DIFFICULTIES you experienced. If NO, skip question`,
             `Do you know where to look for HELP and extra information to make your research reproducible?`,
             `Please rate the perceived IMPORTANCE of doing your research in a reproducible way`,
             `According to you, why is it IMPORTANT (or not) to do your research in a reproducible way?`),
      booktabs = TRUE,
      caption = paste0("Previous experience in reproducibility, main difficulties and perceived importance, \n",
                        "using numeric values 1 to 5 for 'No important at all' to 'Really important'.")) %>% 
  kableExtra::kable_styling(full_width = TRUE) %>%
  kableExtra::scroll_box(height = "600px")
  
```

The plots below refer to the questions above wih numeric/logical answers.

```{r pretest_geomatics_perception_fig, fig.width=10}
categoryColumns <- c("Have you ever experienced DIFFICULTIES \nIN REUSING somebody else’s code / data?",
                     "Have you ever had to REUSE \nYOUR OWN past code/data?",
                     "Please rate the perceived IMPORTANCE of \ndoing your research in a reproducible way")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")

p1 <- questions_barplot(
  geomatics_pretest,
  `Have you ever experienced DIFFICULTIES IN REUSING somebody else’s code / data?`,
  main = paste("A:", categoryColumns[1]), 
  colour = 1, 
  yesno_levels)

p2 <- questions_barplot(
  geomatics_pretest,
  `Have you ever had to REUSE YOUR OWN past code/data?`,
  main = paste("B:", categoryColumns[2]), 
  colour = 2, 
  yesno_levels)

p3 <- questions_barplot(
  geomatics_pretest,
  `Please rate the perceived IMPORTANCE of doing your research in a reproducible way`,
  main = paste("C:", categoryColumns[3]), 
  colour = 3, 
  percepcion_levels)

p1 + p2 + p3 

ggsave(file = here::here("figs", "fig10_geomatica_pretest.png"),
       width = 10, height = 7, dpi = 300)



```

#### Section 2: Current working practices

```{r pretest_geomatics_working_practices}
# questions_practices <- tibble(
#   analysis = c("What tools do you plan to use to ANALYSE data?"),
#   visualisation =c("What tools do you plan to use to VISUALISE/PLOT data?"),
#   writing = c("What tools do you plan to WRITE UP your master thesis or conference/journal article?"),
#   workflow = c("What is your (expected) process of GETTING the summary data, statistical results, figures, maps and tables IN your master thesis document (or conference/journal article)?"))

# 
# practices <- function(data, group) {
#   data %>%
#     separate_rows(practice, sep = "\\),") %>%   # But ")" is also gone..
#     mutate(practice = stringr::str_trim(practice),
#            practice = if_else(str_sub(practice, -1) == ")", practice, paste0(practice, ")"))) %>%
#     add_column(practice_group=group)
# }


working_practices <- data.frame()
for (q in 1:length(questions_practices)) {
  res <- practices(select(geomatics_pretest, practice = questions_practices[[q]]), names(questions_practices)[q])
  working_practices <- bind_rows(working_practices, res)
}


kable(t(questions_practices),
      col.names = c("Practice group - Survey question"), 
      format = "html",
      booktabs = TRUE,
      caption = paste0("Note that responses to 'working practices' were multi-choice (N=", geomatics_n_participants, ").")) %>%
  kable_styling(full_width = TRUE)
```

```{r pretest_geomatics_working_practices_fig,fig.width=15, fig.height=10, dpi=300}

max_bar <- 14
ggplot(working_practices, aes(x=forcats::fct_infreq(practice))) +
    geom_bar(aes(fill=factor(practice_group))) +
    coord_flip() +
    labs(title = "What tools do you plan to use to...?",
         x = "Number of responses",
         y = "Working practices") +
    facet_grid(rows = vars(practice_group), scales = "free_y") +
    guides(fill= FALSE) +
    theme_bw() +
    scale_fill_brewer(palette="Set1") +
    scale_y_continuous(breaks = seq(0, max_bar, by=2))

```


#### Section 3: Previous education background / work experience /...

```{r pretest_geomatics_background_table}
# options(knitr.kable.NA = '-')
kable(geomatics_pretest %>% 
      select(`What BACHELOR DEGREE (or equivalent) did you have when applying for the master programme?`,
             `How many years of PROFESSIONAL EXPERIENCE did you have when applying for the master programme?`,
             `How many years of PROFESSIONAL EXPERIENCE did you have when applying for the master programme?`,
             `In which context are you DEVELOPING your master thesis?`,
             `Please select which sentence better describes the PLAN you have after the completion of your Master thesis`),
      booktabs = TRUE,
      caption = "Previous education background and work experience, and prospects for future.") %>%
  kable_styling(full_width = TRUE)
  
```

### Questionnaire #2 (post-test)


```{r postest_geomatics_stats}

geomatics_postest <- 
  postest_data %>%
  filter(`Please choose your MASTER programme` == c("MSc Geomatics Master (TU Delft)"))

geomatics_n_participants_post <- nrow(geomatics_postest)

```

- `r round((geomatics_n_participants_post / geomatics_total_students)*100, 0)`% (`r geomatics_n_participants_post `/`r geomatics_total_students`) of students answered the second questionnaire.


#### Section 1: Previous knowledge/experience on reproducible research


```{r postest_geomatics_terms, warning=FALSE}
results <- 
  geomatics_postest %>%
  select(pull(terms, column)) %>%
  as.data.frame() %>%
  likert()

summaries <- 
  summary(results) %>%
  inner_join(terms, by=c("Item" ="column")) %>%
  select(school, Item, low, neutral, high, mean, sd)
```

__Imagine that you are going to explain the following terms to somebody else. How well do you KNOW them?__

```{r postest_geomatics_terms_table}
kable(summaries,
      digits = 2,
      row.names = FALSE,
      col.names = c("School of thought", "Term", "low (%)", "neutral (%)", "high (%)", "mean", "sd"),
      format = "html",
      booktabs = TRUE,
      caption = paste0("Percentage of answers in the disagree (low), agree (high) or neutral categories.\n",
                       "Mean response with standard deviation using numeric values 1 to 5 for 'Strongly disagree' to 'Strongly agree'.\n",
                       "Terms are ordered by 'high' category.")) %>%
      kableExtra::kable_styling(full_width = TRUE) %>%
      kableExtra::scroll_box(height = "300px")
```

Table above is the raw data to create the likert-scale plot in next Figure. 


```{r postest_geomatics_terms_fig, fig.width=15, fig.height=14, dpi=300}
plot(results, type="bar", legend = "", legend.position = "bottom",
     low.color = "goldenrod2", high.color="indianred4") +
  ggtitle(paste0("How well do you KNOW these terms? (N=", geotech_n_participants_post, ")")) + 
  theme_bw()

```

__Have you read/watched the available materials (slides, videos, additional papers,etc)?__


```{r postest_geomatics_materials}

material_levels <- unique(geomatics_postest$`Have you read/watched the available materials (slides, videos, additional papers,etc)?`)
geomatics_postest <- 
  geomatics_postest %>%
  mutate(`Have you read/watched the available materials (slides, videos, additional papers,etc)?` = factor(`Have you read/watched the available materials (slides, videos, additional papers,etc)?`, levels = material_levels))

```


```{r postest_geomatics_materials_fig, fig.width=10}
categoryColumns <- c("Have you read/watched the available materials \n(slides, videos, additional papers,etc)?")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")


p1 <- questions_barplot(
  geomatics_postest,
  `Have you read/watched the available materials (slides, videos, additional papers,etc)?`,
  main = paste("A:", categoryColumns[1]), 
  colour = 1, 
  material_levels)

p1

ggsave(file = here::here("figs", "fig11_geomatica_postest.png"),
       width = 10, height = 7, dpi = 300)

```

#### Section 2: Perceived importance of reproducibility in their future careers


```{r postest_geomatics_perception}
# yesno_levels <- c("YES", "NO")
# percepcion_levels <- c("1", "2", "3", "4", "5")
adapt_levels <- unique(geomatics_postest$`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`)

geomatics_postest <- 
  geomatics_postest %>%
  mutate(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?` = factor(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`, levels = adapt_levels),
         `Are you planning to learn more about reproducible research on your own?` = factor(`Are you planning to learn more about reproducible research on your own?`, levels = percepcion_levels),
         `How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?` = factor(`How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`, levels = percepcion_levels))
```


```{r postest_geomatics_perception_table}
options(knitr.kable.NA = '-')
kable(geomatics_postest %>% 
      select(`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`,
             `Are you planning to learn more about reproducible research on your own?`,
             `How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`),
      booktabs = TRUE,
      caption = paste0("Perceived importance of reproducibility in the future, \n",
                        "using numeric values 1 to 5 for 'No important at all' to 'Really important'.")) %>% 
  kableExtra::kable_styling(full_width = TRUE) %>%
  kableExtra::scroll_box(height = "600px")
  
```

The plots below refer to the questions above.

```{r postest_geomatics_perception_fig, fig.width=10}
categoryColumns <- c("Are you going to use/adapt reproducible research \npractice(s) in your current and/or future research \nproject (master thesis, doctoral thesis, etc.)?",
                     "Are you planning to learn more about \nreproducible research on your own?",
                     "How important are reproducibility practices\n for your future professional career \n(academia, industry, government, etc.)?")

n_colours <- ifelse(length(categoryColumns) > 2, length(categoryColumns), 3)
colours <- RColorBrewer::brewer.pal(n_colours, "Set1")

# questionsBarplot = function(data, main, colour, levels) {
#   barplot(table(data, useNA = "no"), 
#           main = main,
#           xlab = "Level", 
#           ylim = c(0,6),
#           names.arg = levels,col = colours[colour])
# }

par(mfrow = c(1,length(categoryColumns)))

# FIXME: Level names are long and are not correctly visualised (Plot A)
# questionsBarplot(geomatics_postest$`Are you going to use/adapt reproducible research practice(s) in your current and/or future research projects (master thesis, doctoral thesis, etc.)?`,
#                 main = paste("A:", categoryColumns[1]), colour = 1, adapt_levels)
# questionsBarplot(geomatics_postest$`Are you planning to learn more about reproducible research on your own?`,
#                 main = paste("B:", categoryColumns[2]), colour = 2, percepcion_levels)
# questionsBarplot(geomatics_postest$`How important are reproducibility practices for your future professional career (academia, industry, government, etc.)?`,
#                 main = paste("C:", categoryColumns[3]), colour = 3, percepcion_levels)




```


### Results of self-assessment reproducibility

**TODO**



# References {-}

<div id="refs"></div>